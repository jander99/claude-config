{
  "$schema": "https://claude.ai/schema/claude-config.json",
  "version": "2.0",
  "description": "Enhanced Claude Code configuration with mandatory agent delegation enforcement",
  
  "agentDelegation": {
    "enforcement": "strict",
    "bypassAllowed": false,
    "violationHandling": "stop_and_request_permission",
    "escalationThreshold": 3,
    "costOptimization": true
  },
  
  "mcpServers": {
    "agent-coordinator": {
      "command": "uv",
      "args": ["run", "claude-config", "serve"],
      "env": {
        "AGENT_ENFORCEMENT": "strict",
        "SAFETY_PROTOCOLS": "enabled",
        "COST_OPTIMIZATION": "enabled"
      }
    },
    "filesystem": {
      "command": "npx",
      "args": ["@modelcontextprotocol/server-filesystem", "/home/jeff/workspaces"]
    },
    "github": {
      "command": "npx",
      "args": ["@modelcontextprotocol/server-github"],
      "env": {
        "GITHUB_PERSONAL_ACCESS_TOKEN": "${GITHUB_TOKEN}"
      }
    }
  },
  
  "toolPermissions": {
    "task": {
      "required": true,
      "description": "Required for agent delegation - cannot be disabled"
    },
    "todowrite": {
      "required": true,
      "description": "Required for task management and coordination"
    },
    "bash": {
      "allowed": true,
      "restrictions": ["git operations require git-helper coordination"]
    },
    "read": {
      "allowed": true
    },
    "write": {
      "allowed": false,
      "reason": "Direct file writing requires agent coordination"
    },
    "edit": {
      "allowed": false,
      "reason": "File editing requires specialized agent coordination"
    }
  },
  
  "behaviorOverrides": {
    "conciseness": {
      "maxLines": 4,
      "exceptions": ["detailed explanations explicitly requested"]
    },
    "proactiveness": {
      "agentActivation": "automatic",
      "patternDetection": "strict",
      "userNotification": "minimal"
    },
    "safetyChecks": {
      "branchProtection": "mandatory",
      "contextVerification": "required",
      "userConfirmation": "for_destructive_operations"
    }
  },
  
  "agentTierOptimization": {
    "costTiers": {
      "haiku": {
        "multiplier": 1.0,
        "agents": ["git-helper", "technical-writer", "project-coordinator"],
        "useCases": ["simple operations", "documentation", "coordination"]
      },
      "sonnet": {
        "multiplier": 2.5,
        "agents": ["python-engineer", "ai-engineer", "java-engineer", "frontend-engineer", "database-engineer", "devops-engineer", "security-engineer", "blockchain-engineer", "data-engineer", "ai-researcher", "business-analyst", "product-manager", "quant-analyst", "customer-success", "performance-engineer", "qa-engineer", "ui-ux-designer", "prompt-engineer"],
        "useCases": ["standard development", "implementation", "testing", "analysis"]
      },
      "opus": {
        "multiplier": 4.0,
        "agents": ["sr-architect", "sr-ai-researcher", "sr-quant-analyst", "integration-architect", "agent-architect"],
        "useCases": ["strategic decisions", "complex architecture", "escalations"]
      }
    },
    "autoTierSelection": true,
    "escalationTracking": true,
    "costMonitoring": true
  },
  
  "detectionPatterns": {
    "python": {
      "fileExtensions": [".py"],
      "projectFiles": ["requirements.txt", "pyproject.toml", "setup.py", "pipfile"],
      "keywords": ["python", "flask", "django", "fastapi"],
      "requiredAgent": "python-engineer",
      "priority": "critical"
    },
    "javascript": {
      "fileExtensions": [".js", ".jsx", ".ts", ".tsx"],
      "projectFiles": ["package.json", "tsconfig.json"],
      "keywords": ["react", "vue", "angular", "node"],
      "requiredAgent": "frontend-engineer",
      "priority": "critical"
    },
    "java": {
      "fileExtensions": [".java"],
      "projectFiles": ["pom.xml", "build.gradle"],
      "keywords": ["spring", "maven", "gradle"],
      "requiredAgent": "java-engineer",
      "priority": "critical"
    },
    "database": {
      "fileExtensions": [".sql"],
      "projectFiles": ["schema.sql", "migrations/"],
      "keywords": ["database", "postgresql", "mysql", "mongodb"],
      "requiredAgent": "database-engineer", 
      "priority": "critical"
    },
    "infrastructure": {
      "fileExtensions": [".yml", ".yaml"],
      "projectFiles": ["Dockerfile", "docker-compose.yml", "kubernetes/"],
      "keywords": ["docker", "kubernetes", "terraform", "ansible"],
      "requiredAgent": "devops-engineer",
      "priority": "critical"
    },
    "blockchain": {
      "fileExtensions": [".sol"],
      "keywords": ["web3", "defi", "blockchain", "ethereum", "smart contract"],
      "requiredAgent": "blockchain-engineer",
      "priority": "critical"
    },
    "machinelearning": {
      "fileExtensions": [".ipynb"],
      "keywords": ["torch", "tensorflow", "sklearn", "model", "training", "ml"],
      "requiredAgent": "ai-engineer",
      "priority": "critical"
    }
  },
  
  "workflowCoordination": {
    "mandatoryHandoffs": {
      "development_to_testing": {
        "from": ["python-engineer", "java-engineer", "frontend-engineer", "ai-engineer"],
        "to": "qa-engineer",
        "condition": "after_implementation_completion"
      },
      "testing_to_documentation": {
        "from": "qa-engineer", 
        "to": "technical-writer",
        "condition": "for_user_facing_features"
      },
      "feature_to_version_control": {
        "from": ["*-engineer"],
        "to": "git-helper",
        "condition": "after_feature_completion"
      }
    },
    "escalationPaths": {
      "development_failures": {
        "threshold": 3,
        "escalateTo": "sr-architect"
      },
      "research_complexity": {
        "triggers": ["multi-domain", "novel methodology"],
        "escalateTo": "sr-ai-researcher"
      },
      "financial_complexity": {
        "triggers": ["advanced modeling", "risk management"],
        "escalateTo": "sr-quant-analyst"
      }
    }
  },
  
  "complianceMonitoring": {
    "trackMetrics": [
      "agent_delegation_rate",
      "escalation_frequency", 
      "cost_per_task",
      "quality_assurance_completion",
      "branch_safety_adherence"
    ],
    "reportingLevel": "session_summary",
    "complianceThreshold": 0.95,
    "violationActions": ["warn", "restrict", "escalate"]
  },
  
  "userExperience": {
    "notifications": {
      "agentActivation": "minimal",
      "escalations": "detailed",
      "costWarnings": "enabled"
    },
    "overridePermissions": {
      "emergencyBypass": true,
      "explicitUserRequest": true,
      "systemFailure": true
    }
  }
}