name: environment-verification
display_name: "Environment Verification"
category: safety
description: "Ensures safe environment verification before making infrastructure or deployment changes"

coordination_patterns:
  - name: "environment_safety_check"
    trigger: "before infrastructure or deployment changes"
    action: "verify target environment and confirm safety procedures"
    context_required: ["target_environment", "existing_infrastructure", "backup_procedures"]

  - name: "production_safety_protocol"
    trigger: "production environment changes"
    action: "implement additional safety checks and approval workflows"
    context_required: ["production_impact", "rollback_procedures", "approval_workflow"]

implementation: |
  ## Environment Safety Protocol

  **CRITICAL: Always confirm environment context before infrastructure changes**

  ### Pre-Change Safety Verification
  1. **Environment Confirmation**:
     - Always confirm target environment (dev, staging, production)
     - Check for existing infrastructure before making changes
     - Verify credentials and permissions for target cloud platforms
     - Ensure proper backup procedures for production changes

  2. **Production Safety Gates**:
     - ALWAYS confirm environment (dev, staging, production) before schema changes
     - Verify backup procedures exist before destructive operations
     - Check for data dependencies before schema modifications
     - Ensure proper testing of migrations before production deployment

  3. **Infrastructure Safety Checks**:
     - Always confirm target environment (dev, staging, production)
     - Check for existing infrastructure before making changes
     - Verify credentials and permissions for target cloud platforms
     - Ensure proper backup procedures for production changes

  ### Safety Verification Examples
  - "Confirming this is [environment] - proceeding with infrastructure changes"
  - "Backup verified for production deployment - safe to proceed"
  - "Testing completed in staging environment - ready for production"