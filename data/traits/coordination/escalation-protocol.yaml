name: escalation-protocol
display_name: "Escalation Protocol"
category: coordination
description: "Universal escalation triggers and procedures for complex issues"

coordination_patterns:
  - name: "three_strike_escalation"
    trigger: "after 3 failed attempts by any development agent"
    action: "escalate to sr-architect"
    required_context: "original_request, attempted_solutions, failure_reasons, current_state"

  - name: "complexity_escalation"
    trigger: "multi-system integration or architecture decisions"
    action: "immediate escalation to sr-architect"
    required_context: "system_complexity, integration_requirements, architectural_decisions"

  - name: "research_escalation"
    trigger: "advanced research requiring multi-domain synthesis"
    action: "escalate to sr-ai-researcher"
    required_context: "research_scope, methodology_requirements, domain_complexity"

  - name: "financial_escalation"
    trigger: "sophisticated quantitative modeling requirements"
    action: "escalate to sr-quant-analyst"
    required_context: "modeling_complexity, financial_requirements, risk_considerations"

implementation: |
  ## Universal Escalation Protocol

  ### Automatic Escalation Conditions:

  #### 1. Three-Strike Rule
  **Trigger**: After 3 failed attempts by any development agent
  **Action**: Escalate to `sr-architect`
  **Required Context**:
  - Original user request
  - List of agents that attempted the work
  - Specific reasons why each attempt failed
  - Current system state and constraints
  - Specific guidance needed for resolution

  #### 2. Complex Integration
  **Trigger**: Multi-system architecture decisions
  **Action**: Immediate escalation to `sr-architect`
  **Context**: System complexity, integration patterns, architectural decisions needed

  #### 3. Advanced Research
  **Trigger**: Complex methodology or multi-domain synthesis
  **Action**: Escalate to `sr-ai-researcher`
  **Context**: Research scope, methodology requirements, domain expertise needed

  #### 4. Financial Complexity
  **Trigger**: Sophisticated quantitative modeling
  **Action**: Escalate to `sr-quant-analyst`
  **Context**: Modeling requirements, risk analysis needs, regulatory considerations

  ### Escalation Context Format:
  ```
  Escalation Context:
  - Original Request: [user's exact request]
  - Agent Attempts: [list of agents that tried]
  - Failure Reasons: [why each attempt failed]
  - Current State: [system state and constraints]
  - Specific Guidance Needed: [what decisions are required]
  ```

  ### Escalation Examples:
  - "After 3 failed attempts at database optimization, escalating to sr-architect"
  - "Complex microservices architecture decision requires sr-architect guidance"  
  - "Advanced ML methodology requires sr-ai-researcher expertise"
  - "Sophisticated risk modeling requires sr-quant-analyst analysis"

  ### Post-Escalation Protocol:
  After senior agent provides guidance:
  1. **Delegate Implementation**: Hand off to appropriate specialist agent
  2. **Quality Coordination**: Ensure qa-engineer validates the solution
  3. **Documentation**: Coordinate with technical-writer for solution documentation
  4. **Knowledge Capture**: Update patterns for future similar issues